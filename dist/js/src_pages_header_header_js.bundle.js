/*! For license information please see src_pages_header_header_js.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkbookstore_webpack=self.webpackChunkbookstore_webpack||[]).push([["src_pages_header_header_js"],{"./src/assets/js/book.js":(e,t,o)=>{o.r(t),o.d(t,{deleteBookById:()=>k,findAllBookTypes:()=>n,findAllBooks:()=>i,findBookByBooksAndId:()=>l,findBookById:()=>c,findBookTypeByTypeName:()=>r,findBooksByTypeName:()=>a,minusBookSotckByBookId:()=>d,saveBook:()=>u});var s=o("./src/assets/js/data.js");function n(){let e=JSON.parse(window.sessionStorage.getItem("bookTypes"));return null==e&&(window.sessionStorage.setItem("bookTypes",JSON.stringify(Object.values(s.BookTypes))),e=JSON.parse(window.sessionStorage.getItem("bookTypes"))),e=e.map((e=>new s.BookType(e.typeId,e.typeName,e.color))),e}function r(e){let t=n().filter((t=>t.typeName==e));return 1==t.length?t[0]:null}function i(){return y()}function c(e){const t=y().filter((t=>t.id==e));return 0==t.length?null:t[0]}function l(e,t){const o=e.filter((e=>e.id==t));return 0==o.length?null:o[0]}function a(e){return y().filter((t=>t.type.typeName==e))}function d(e,t){let o=y(),s="";return o.filter((t=>t.id==e)).forEach((e=>{e.stockQty-t<0?s=`${e.name} 已經無庫存`:e.stockQty=e.stockQty-t})),""==s&&f(o),s}function u(e){let t=y();try{let o=l(t,e.id);if(null==o)throw Error(`Not Found: Book Id - ${e.id}`);if(Object.assign(o,e),o.stockQty<0)throw Error(`Stock Qty Error: Book Id - ${e.id}`);return f(t),1}catch(e){throw e}}function k(e){let t=y();try{if(null==l(t,e))throw Error(`Not Found: Book Id - ${e}`);return t=t.filter((t=>t.id!=e)),f(t),1}catch(e){throw e}return 1}function f(e){window.sessionStorage.setItem("books",JSON.stringify([...e]))}function y(){let e=JSON.parse(window.sessionStorage.getItem("books"));return null==e&&(f(s.books),e=JSON.parse(window.sessionStorage.getItem("books"))),[...e].map((e=>{Object.setPrototypeOf(e,s.Book.prototype)})),e}},"./src/assets/js/cart.js":(e,t,o)=>{o.r(t),o.d(t,{addToCart:()=>n,findAllCartItems:()=>r});var s=o("./src/assets/js/book.js");function n(e){let t=(0,s.minusBookSotckByBookId)(e,1);if(""!==t)return void alert(t);alert(`已加入購物車${e}`);let o=r();o.push(e),window.sessionStorage.setItem("cartItems",o.join(",")),window.location.reload()}function r(){let e=null==window.sessionStorage.getItem("cartItems")?"":window.sessionStorage.getItem("cartItems");return e=""==e?[]:e.split(","),e}},"./src/pages/header/header.js":(e,t,o)=>{o.r(t),o("./src/styles.css"),o("./node_modules/lodash/lodash.js");var s=o("./src/assets/js/user.js"),n=o("./src/assets/js/cart.js");const r=(0,s.getSessionUser)();console.log(r),document.querySelector("#username").textContent=r.username,document.querySelector("#cartItemsCtn").textContent=(0,n.findAllCartItems)().length+"",document.querySelector("#logout").addEventListener("click",(function(){(0,s.logout)()})),1==r.role.roleId&&document.querySelector("#backBtn").classList.toggle("hidden"),document.querySelector("#backBtn").addEventListener("click",(function(){(0,s.isAdmin)()&&(window.location.href="./back.html")}))}}]);
//# sourceMappingURL=src_pages_header_header_js.bundle.js.map