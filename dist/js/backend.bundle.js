/*! For license information please see backend.bundle.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/assets/js/book.js":(e,t,o)=>{o.r(t),o.d(t,{deleteBookById:()=>p,findAllBookTypes:()=>r,findAllBooks:()=>i,findBookByBooksAndId:()=>d,findBookById:()=>a,findBookTypeByTypeName:()=>s,findBooksByTypeName:()=>l,minusBookSotckByBookId:()=>u,saveBook:()=>c});var n=o("./src/assets/js/data.js");function r(){let e=JSON.parse(window.sessionStorage.getItem("bookTypes"));return null==e&&(window.sessionStorage.setItem("bookTypes",JSON.stringify(Object.values(n.BookTypes))),e=JSON.parse(window.sessionStorage.getItem("bookTypes"))),e=e.map((e=>new n.BookType(e.typeId,e.typeName,e.color))),e}function s(e){let t=r().filter((t=>t.typeName==e));return 1==t.length?t[0]:null}function i(){return m()}function a(e){const t=m().filter((t=>t.id==e));return 0==t.length?null:t[0]}function d(e,t){const o=e.filter((e=>e.id==t));return 0==o.length?null:o[0]}function l(e){return m().filter((t=>t.type.typeName==e))}function u(e,t){let o=m(),n="";return o.filter((t=>t.id==e)).forEach((e=>{e.stockQty-t<0?n=`${e.name} 已經無庫存`:e.stockQty=e.stockQty-t})),""==n&&y(o),n}function c(e){let t=m();try{let o=d(t,e.id);if(null==o)throw Error(`Not Found: Book Id - ${e.id}`);if(Object.assign(o,e),o.stockQty<0)throw Error(`Stock Qty Error: Book Id - ${e.id}`);return y(t),1}catch(e){throw e}}function p(e){let t=m();try{if(null==d(t,e))throw Error(`Not Found: Book Id - ${e}`);return t=t.filter((t=>t.id!=e)),y(t),1}catch(e){throw e}return 1}function y(e){window.sessionStorage.setItem("books",JSON.stringify([...e]))}function m(){let e=JSON.parse(window.sessionStorage.getItem("books"));return null==e&&(y(n.books),e=JSON.parse(window.sessionStorage.getItem("books"))),[...e].map((e=>{Object.setPrototypeOf(e,n.Book.prototype)})),e}},"./src/assets/js/data.js":(e,t,o)=>{function n(e,t,o){this.typeId=e,this.typeName=t,this.color=o}function r(e,t,o,n,r){this.id=e,this.type=t,this.name=o,this.price=n,this.stockQty=r}function s(e,t,o,n,r,s){this.userId=e,this.orderId=t,this.orderTime=o,this.totalPrice=n,this.totalQty=r,this.status=s}function i(e,t,o,n,r,s){this.orderId=e,this.bookId=t,this.price=o,this.qty=n,this.total=r,this.status=s}function a(e,t){this.id=e,this.name=t}function d(e,t){this.roleId=e,this.roleName=t}function l(e,t,o,n,r){this.id=e,this.username=t,this.password=o,this.email=n,this.role=r}o.r(t),o.d(t,{Book:()=>r,BookType:()=>n,BookTypes:()=>y,Order:()=>s,OrderItem:()=>i,OrderStatus:()=>u,Role:()=>d,Roles:()=>c,Status:()=>a,User:()=>l,books:()=>m,orderItems:()=>k,orders:()=>f,users:()=>p}),r.newInstance=function(e,t,o,s,i,a,d){let l=new n(Number(t),String(o),String(s));return new r(Number(e),l,String(i),Number(a),Number(d))},r.prototype.getImageUrl=function(){return`https://picsum.photos/240/224?random=${this.id}`};const u={WAITING:new a(1,"待出貨"),ONGOING:new a(2,"已出貨"),ARRIVED:new a(3,"已到門市")},c={ADMIN:new d(1,"ADMIN"),USER:new d(2,"USER")},p=[new l(1,"admin","admin","admin@example.com",c.ADMIN),new l(2,"user","user","user@example.com",c.USER)],y={IT:new n(1,"IT","green"),Lang:new n(2,"Lang","purple"),Social:new n(2,"Social","blue")},m=[new r(1,y.IT,"Java",400,20),new r(2,y.IT,"Javascript",400,10),new r(3,y.IT,"Spring",700,25),new r(4,y.IT,"Python",350,2),new r(5,y.IT,"SQL",400,3),new r(6,y.Lang,"華語文",600,20),new r(7,y.Lang,"英語",800,6),new r(8,y.Lang,"法語",800,4),new r(9,y.Lang,"多益檢定",1700,20),new r(10,y.Lang,"全民英檢",1500,50),new r(11,y.Social,"社會學",300,3)],f=[new s(1,"20231024012313","2023/10/24 23:48:52",750,2,u.ONGOING),new s(1,"20231024012314","2023/10/25 11:05:10",4e3,2,u.ARRIVED),new s(2,"20231024012312","2024/12/15 20:00:05",800,1,u.WAITING)],k=[new i("20231024012313",1,400,1,400,u.ONGOING),new i("20231024012313",4,350,1,350,u.ONGOING),new i("20231024012312",7,800,1,800,u.WAITING),new i("20231024012314",9,1700,1,1700,u.ARRIVED),new i("20231024012314",10,1500,1,1500,u.ARRIVED),new i("20231024012314",7,800,1,800,u.ARRIVED)]}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{o.r(n);var e=o("./src/assets/js/book.js"),t=o("./src/assets/js/data.js");console.info((0,e.findAllBooks)()),console.info((0,e.findAllBookTypes)());let r=(0,e.findAllBooks)(),s=(0,e.findAllBookTypes)();[...r].map((e=>{$("tbody").append(`\n           <tr>\n                <td>${e.id}</td>\n                <td>\n                    ${function(e){let t="";return s.map((o=>{t+=`<option value='${o.typeName}' ${e.type.typeName==o.typeName?"selected":""}>${o.typeName}</option>`})),`\n    <select class="typeName" id="typeName_${e.id}" value='${e.type.typeName}'>\n        ${t}\n    </select>`}(e)}\n                </td>\n                <td class="name">\n                    <input class="rounded border-2 focus:outline-none focus:border-green-500 p-1" type='text' id="bookName_${e.id}" value="${e.name}" />\n                </td>\n                <td class="price">\n                    <input class="rounded border-2 focus:outline-none focus:border-green-500 p-1 w-full" type='number' id="bookPrice_${e.id}" value="${e.price}" />\n                </td>\n                <td class="stockQty">\n                    <input class="rounded border-2 focus:outline-none focus:border-green-500 p-1 w-full" type='number' id="bookStockQty_${e.id}" value="${e.stockQty}" />\n                </td>\n                <td class="flex text-nowrap">\n                    <button type="button" class="btn-success mx-1 update" data-book-id="${e.id}">更新</button>\n                    <button type="button" class="btn-danger mx-1 delete" data-book-id="${e.id}">刪除</button>\n                </td>\n           </tr>\n        `)})),$(".update").on("click",(function(){let o=Number($(this).attr("data-book-id")),n=$("#typeName_"+o).attr("value"),r=String($("#bookName_"+o).val()),s=Number($("#bookPrice_"+o).val()),i=Number($("#bookStockQty_"+o).val()),a=(0,e.findBookTypeByTypeName)(n);try{1==(0,e.saveBook)(t.Book.newInstance(o,a.typeId,a.typeName,a.color,r,s,i))&&alert(`更新成功: ${r} (${o})`)}catch(e){alert(e)}window.location.reload()})),$(".delete").on("click",(function(){let t=Number($(this).attr("data-book-id")),o=String($("#bookName_"+t).val());try{confirm(`確定要刪除 ${o}?`)&&(0,e.deleteBookById)(t)}catch(e){alert(e)}window.location.reload()})),$(".typeName").on("change",(function(e){let t=$(e.target).val();$(e.target).attr("value",t.toString())}))})()})();
//# sourceMappingURL=backend.bundle.js.map